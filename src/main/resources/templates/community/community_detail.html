<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/layout}">

<head th:replace="fragments/config :: configFragment">
	<style>
		.answerForm {
			width: 500px;
			height: 100px;
		}
	</style>
</head>

<body>
	<div id="wrap">
		<header th:replace="fragments/header :: headerFragment"></header>
		<div th:replace="fragments/menu :: menuFragment"></div>
		<section id="community_section01" class="potion">
			<div class="community_text">
				<h1>Community</h1>
				<h3>The standard chunk of Lorem Ipsum used since the 1500s is reproduced below for those interested.
					<br>
					Sections 1.10.32 and 1.10.33 from "de Finibus Bonorum et Malorum" by Cicero are also reproduced in
					their exact original form.
				</h3>
			</div>
		</section>
		<section id="community_detail_section01">
			<a class="detail_modify" th:href="@{|/community/modify/${board.id}|}">
				<button type="button" value="Modify">Modify</button></a>
			<div class="detail_view_area potion">
				<div class="detail_category_area">
					<div th:if="${board.category} != null" th:text="|${board.category}|"></div>
					<div th:if="${board.location} != null" th:text="|${board.location}|"></div>
					<div th:if="${board.country} != null" th:text="|${board.country}|"></div>
				</div>
				<div class="detail_title" th:text="${board.title}"></div>
				<div class="detail_content" th:text="${board.content}"></div>
				<div class="detail_profile">
					<!-- contentor profile -->
				</div>
			</div>
			<div class="detail_answer_area potion">
				<div class="answer_text">Answer</div>
				<div class="answer_profile">
					<!-- answer profile -->
				</div>
				<div class="detail_answer_input_area">
					<form class="answer_modify" th:action="@{|/answer/create/${board.id}|}" th:object="${answerForm}"
						method="post">
						<textarea th:field="*{content}" rows="2"></textarea>
						<div th:replace="board/form_errors :: formErrorsFragment"></div>
						<input type="submit" value="Confirm">
					</form>
				</div>
				<div class="detail_answer_list_area" th:each="answer : ${board.answerList}">
					<div class="answer_profile">
						<!-- answer profile -->
					</div>
					<div>
						<span th:if="${answer.writer != null}" th:text="${answer.writer.username}"></span></a>

						<!-- 수정폼 -->
						<form th:object="${answerForm}" method="post" style="display: block; margin-left:200px;">
							<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
							<div class="mb-3">
								<label for="content" class="form-label">내용</label>
								<textarea th:field="*{content}" rows="2"></textarea>
							</div>
							<input type="submit" value="저장하기" class="btn">
						</form>
						<!-- //수정폼 -->


						<a th:id="|answer_${answer.id}|">
							<div class="answer_date"
								th:text="${#temporals.format(answer.createDate, 'yyyy-MM-dd HH:mm')}"></div>
							<div class="answer_content" th:text="${answer.content}">
							</div>
						</a>

						<!-- 수정버튼, 차후에 권한부여 -->
						<div class="answer_option_section">
							<!-- th:href="@{|/answer/modify/${answer.id}|}" -->
							<a class="answer_modify" th:text="Modify"></a>

							<a class="answer_delete" href="javascript:void(0);"
								th:data-uri="@{|/answer/delete/${answer.id}|}" th:text="Delete"></a>
						</div>
					</div>
				</div>
			</div>
		</section>
	</div>
</body>
<script>

	$(document).ready(function () {
		$(".answer_modify").on('click', function (e) {
			console.log("click");

		});
	});

	const delete_elements = document.getElementsByClassName("answer_delete");
	Array.from(delete_elements).forEach(function (element) {
		element.addEventListener('click', function () {
			if (confirm("Really?")) {
				location.href = this.dataset.uri;
			};
		});
	});
</script>

</html>